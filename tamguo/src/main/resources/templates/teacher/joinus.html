<!DOCTYPE html>
<html lang="Zh-hans" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>教师招募_探果网</title>
		<meta name="description" content="教师招募_探果网"/>
		<meta name="author" content="Tamguo Team" />
		<meta name="copyright" content="Tamguo" />
		<link rel="stylesheet" th:href="${setting.domain + 'css/reset.css'}" />
		<link rel="stylesheet" th:href="${setting.domain + 'css/teacher/joinus.css'}" />
		<link type="favicon" rel="shortcut icon" th:href="${setting.domain + 'images/favicon.png'}" />
		<!-- 引入样式 -->
		<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	</head>
	<body>
		<div id="wrapper" class="">
		    <div id="head">
		        <div class="mod-header">
		            <a th:href="${setting.domain}" style="display: block;">
		                <img th:src="${setting.domain + 'images/logo_731bc32.png'}" alt="logo"></a>
		        </div>
		    </div>
		    <div id="nav">
		        <div class="nav-2">
		            <div class="mod-nav clearfix">
		                <h1 class="page-type-notab"></h1>
		            </div>
		        </div>
		    </div>
		    <div id="content">
		        <div class="mod-reg clearfix mod-reg-">
					<div id="infoForm">
						<el-steps :active="active" finish-status="success">
						  <el-step title="手机号"></el-step>
						  <el-step title="档案信息"></el-step>
						  <el-step title="审核状态"></el-step>
						</el-steps>
						<div v-show="active == 1" style="width:90%;margin-top:50px;">
							<el-form ref="mobileForm" :model="mobileModel" :rules="rules" label-width="120px">
							  <el-form-item label="手机号" prop="mobile">
							    <el-input v-model="mobileModel.mobile"></el-input>
							  </el-form-item>
							  <el-form-item label="验证码" prop="verifyCode">
							    <el-input v-model="mobileModel.verifyCode"></el-input>
							  </el-form-item>
							</el-form>
						</div>
						<div v-show="active == 2" style="width:90%;margin-top:50px;">
							<el-form ref="form" :model="teacher" label-width="120px">

								  <el-form-item label="地区">
									  <el-cascader
									    :options="options"
									    v-model="selectedOptions"
									    @change="handleChange">
									  </el-cascader>
								  </el-form-item>
								  <el-form-item label="科目">
								    <el-cascader
									    :options="options"
									    v-model="selectedOptions"
									    @change="handleChange">
									  </el-cascader>
								  </el-form-item>
								  <el-form-item label="学校">
								    <el-cascader
									    :options="options"
									    v-model="selectedOptions"
									    @change="handleChange">
									  </el-cascader>
								  </el-form-item>
								  <el-form-item label="姓名">
								    <el-input v-model="teacher.name"></el-input>
								  </el-form-item>
								    <el-form-item label="座右铭">
								    <el-input type="textarea" v-model="teacher.motto"></el-input>
								  </el-form-item>
							</el-form>
						</div>
						<div v-show="active == 3" style="width:90%;margin-top:50px;">
							<el-form ref="form" :model="teacher" label-width="120px">
							  <el-form-item label="手机号3">
							    <el-input v-model="teacher.mobile"></el-input>
							  </el-form-item>
							</el-form>
						</div>
						<el-row>
						  <el-col :span="24">
						  	<div class="grid-content bg-purple-dark" style="text-align: center;">
						  		<el-button @click="next()">下一步</el-button>
						  	</div>
						  </el-col>
						</el-row>
					</div>
		            <div class="login-link" id="login_link">
		                <span>我已加入，现在就</span>
		                <button class="login-btn" id="login_btn">登录</button></div>
		        	</div>
				    <div id="foot">
				        <div class="mod-footer">
				            <div class="copy-box">2018&nbsp;©Tamguo</div></div>
				    </div>
				</div>
			</div>
	</body>
	<script type="text/javascript" th:inline="javascript">
	var mainHttp = [[${setting.domain}]];
	</script>
	<script type="text/javascript" th:src="${setting.domain + 'js/jquery-1.8.3.min.js'}"></script>
	<script type="text/javascript" th:src="${setting.domain + 'js/member/register.js'}"></script>
	<!-- 引入组件库 -->
	<script type="text/javascript" src="https://vuejs.org/js/vue.min.js"></script>
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script type="text/javascript">
		var vm = new Vue({
		  el: '#infoForm',
		  data:{
			  	mobileModel: {
		          mobile: '',
		          verifyCode:''
		        },
		        teacher:{
		        	mobile:null
		        },
		        rules: {
		        	mobile: [
		                { required: true, message: '请输入手机号', trigger: 'blur' },
		                { pattern: /^1[345678]\d{9}$/, message: '手机号格式错误', trigger: 'blur' }
		            ],
		            verifyCode: [
		            	{required: true, message: '请输入验证码', trigger: 'blur'},
		            	{min:6, max:6, message: '验证码格式错误', trigger: 'blur' }
		            ]
		        },
		        active: 1,
		        options: [],
		          selectedOptions: [],
		          selectedOptions2: []
		  },
		  methods: {
		      next:function(){
		    	  // 第一步
		    	  if(vm.active == 1){
		    		  this.$refs.mobileForm.validate((valid) => {
			    		  if (valid) {
						      if(this.active == 1){
					    		  axios.all([this.getTeacher()]).then(axios.spread(function (tResponse) {
					    		     if(tResponse.data.code == 201){
					    		    	  vm.$message({showClose:true,duration:1000,message:'验证码错误，请重新输入！',type:'error',onClose:function(){
					    		    		  vm.mobileModel.verifyCode = "";
							    		      vm.$refs.mobileForm.validate('verifyCode');
					    		    	  }});
					    		     }else if(tResponse.data.code == 202){
					    		    	 vm.active = 2;
					    		     }
					    		  }));
					    	  }
		    	          } else {
		    	             console.log('error submit!!');
		    	             return false;
		    	          }
			          });
		    	  }else if(active == 2){ // 第二步
		    		  
		    	  }
		      },
		      getTeacher:function(){
		    	  return axios.post(mainHttp + 'teacher/info.html',{mobile: '15618910786',verifyCode: 'Flintstone'});
		      },
		      handleChange(value) {
		          console.log(value);
		      },
		      getArea:function(){
		    	  axios.get(mainHttp + 'libs/area.json').then(function(response){
		    		  vm.options = response.data;
		    	  });
		      }
		    }
		});
		vm.getArea();
	</script>
</html>